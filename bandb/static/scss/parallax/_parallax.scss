@charset "utf-8";

@function make-layer-distance-list($structure) {
  $list: ();
  $last: null;
  @each $step, $stop in $structure {
    @if ($step != 0px) {
      $list: join($list, rangeto($last, $stop, $step));
    }
    $last: $stop;
  }
  $list: append($list, $last);
  @return $list;
}
@function rangeto($start, $end, $step) {
  $list: ();
  @for $n from $start / $step to $end / $step {
    $list: append($list, $n * $step);
  }
  @return $list;
}
@function range($start, $end, $step) {
  @return append(rangeto($start, $end, $step), $end);
}

$viewer-distance: 300px;
$layer-distances: make-layer-distance-list((0px -600px, 100px -300px, 50px -150px, 25px 100px, 20px -60px, 10px 100px, 20px 200px));
@debug $layer-distances;

html, body {
  transform: translateZ(0);
  overflow: hidden;
  margin: 0;
  padding: 0;
  height: 100%;
}
.plx-viewport {
  height: 100%;
  width: 100%;
  overflow-x: hidden;
  overflow-y: auto;
  perspective: $viewer-distance;
  position: absolute;
  scroll-behavior: smooth;
  padding: 0;
  margin: 0;
  box-sizing: border-box;
}
.plx-group {
  position: relative;
  transform-style: preserve-3d;
  padding: 0;
  margin: 0;
  box-sizing: border-box;
  transition: transform 1s;
}
%plx-layer {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 0;
  margin: 0;
  box-sizing: border-box;
  background-position: bottom center;
  background-repeat: no-repeat;
  background-size: auto;
  background-attachment: scroll;
  text-align: center;
}
@mixin translateZ-and-scale($distance) {
    transform: translateZ($distance) scale(1 - $distance / $viewer-distance);
}
.plx-base {
  @extend %plx-layer;
  position: relative;
  @include translateZ-and-scale(0px);
  &.solid {
    background-color: $background-color;
  }
}
@each $d in $layer-distances {
  @if ($d != 0px) {
    .plx-#{if($d < 0, 'n' + (-$d / 1px), $d / 1px)} {
      @extend %plx-layer;
      @include translateZ-and-scale($d);
    }
  }
}
.debug-on .plx-group {
  transform: translate3d(700px, 0, -800px) rotateY(40deg);
}
.debug-on .plx-layer, .debug-on .plx-base {
  outline: 1px black solid;
}
